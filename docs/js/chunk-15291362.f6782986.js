(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15291362"],{"1d21":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",{attrs:{direction:"horizontal"}},[n("div",{attrs:{id:"WebGL-output"}}),n("div",{staticStyle:{width:"100%"},attrs:{id:"Info-output"}},[n("el-button",{staticStyle:{width:"100%","text-align":"left"},on:{click:function(e){t.viewDirection("front")}}},[t._v("front hemishpere")]),n("br"),n("el-button",{staticStyle:{width:"100%","text-align":"left"},on:{click:function(e){t.viewDirection("back")}}},[t._v("back hemishpere")]),n("br"),n("el-button",{staticStyle:{width:"100%","text-align":"left"},on:{click:function(e){t.viewDirection("left")}}},[t._v("left hemishpere")]),n("br"),n("el-button",{staticStyle:{width:"100%","text-align":"left"},on:{click:function(e){t.viewDirection("right")}}},[t._v("right hemishpere")]),n("br"),n("el-button",{staticStyle:{width:"100%","text-align":"left"},on:{click:function(e){t.viewDirection("top")}}},[t._v("top hemishpere")]),n("br"),n("el-button",{staticStyle:{width:"100%","text-align":"left"},on:{click:function(e){t.viewDirection("bottom")}}},[t._v("bottom hemishpere")]),n("br"),n("el-button",{staticStyle:{width:"100%","text-align":"left"},on:{click:t.photo}},[t._v("create view")])],1),n("el-dialog",{attrs:{title:"photo panel",visible:t.photoVisible,"modal-append-to-body":!1},on:{"update:visible":function(e){t.photoVisible=e}}},[n("div",{attrs:{id:"photo"}})])],1)},o=[],a=(n("ac6a"),n("a481"),n("cadf"),n("551c"),n("097d"),n("5a89")),r=n("5698");n("f751");function s(t){this.manager=void 0!==t?t:a["e"]}Object.assign(s.prototype,{constructor:s,addEventListener:a["g"].prototype.addEventListener,hasEventListener:a["g"].prototype.hasEventListener,removeEventListener:a["g"].prototype.removeEventListener,dispatchEvent:a["g"].prototype.dispatchEvent,load:function(t,e){var n=this;e(n.parse(t))},parse:function(t){var e,n,i=new a["j"];function o(t,e,n){i.vertices.push(new a["E"](t,e,n))}function r(t,e,n){i.faces.push(new a["h"](t,e,n))}e=/([\+|\-]?[\d]+[\.][\d|\-|e]+)[ ]+([\+|\-]?[\d]+[\.][\d|\-|e]+)[ ]+([\+|\-]?[\d]+[\.][\d|\-|e]+)/g;while(null!=(n=e.exec(t)))o(parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3]));e=/([\d]+)[ ]+([\d]+)[ ]+([\d]+)/g;while(null!=(n=e.exec(t)))r(parseInt(n[1])-1,parseInt(n[2])-1,parseInt(n[3])-1);return i.computeFaceNormals(),i.computeVertexNormals(),i.computeBoundingBox(),(new a["b"]).fromGeometry(i)}});n("673e");function c(t,e,n){if(t instanceof a["c"]){console.warn("THREE.DragControls: Constructor now expects ( objects, camera, domElement )");var i=t;t=e,e=i}var o=new a["s"],r=new a["u"],s=new a["D"],c=new a["E"],l=new a["E"],u=null,d=null,p=this;function h(){n.addEventListener("mousemove",v,!1),n.addEventListener("mousedown",g,!1),n.addEventListener("mouseup",y,!1),n.addEventListener("mouseleave",y,!1),n.addEventListener("touchmove",b,!1),n.addEventListener("touchstart",w,!1),n.addEventListener("touchend",E,!1)}function f(){n.removeEventListener("mousemove",v,!1),n.removeEventListener("mousedown",g,!1),n.removeEventListener("mouseup",y,!1),n.removeEventListener("mouseleave",y,!1),n.removeEventListener("touchmove",b,!1),n.removeEventListener("touchstart",w,!1),n.removeEventListener("touchend",E,!1)}function m(){f()}function v(i){i.preventDefault();var a=n.getBoundingClientRect();if(s.x=(i.clientX-a.left)/a.width*2-1,s.y=-(i.clientY-a.top)/a.height*2+1,r.setFromCamera(s,e),u&&p.enabled)return r.ray.intersectPlane(o,l)&&u.position.copy(l.sub(c)),void p.dispatchEvent({type:"drag",object:u});r.setFromCamera(s,e);var h=r.intersectObjects(t);if(h.length>0){var f=h[0].object;o.setFromNormalAndCoplanarPoint(e.getWorldDirection(o.normal),f.position),d!==f&&(p.dispatchEvent({type:"hoveron",object:f}),n.style.cursor="pointer",d=f)}else null!==d&&(p.dispatchEvent({type:"hoveroff",object:d}),n.style.cursor="auto",d=null)}function g(i){i.preventDefault(),r.setFromCamera(s,e);var a=r.intersectObjects(t);a.length>0&&(u=a[0].object,r.ray.intersectPlane(o,l)&&c.copy(l).sub(u.position),n.style.cursor="move",p.dispatchEvent({type:"dragstart",object:u}))}function y(t){t.preventDefault(),u&&(p.dispatchEvent({type:"dragend",object:u}),u=null),n.style.cursor=d?"pointer":"auto"}function b(t){t.preventDefault(),t=t.changedTouches[0];var i=n.getBoundingClientRect();if(s.x=(t.clientX-i.left)/i.width*2-1,s.y=-(t.clientY-i.top)/i.height*2+1,r.setFromCamera(s,e),u&&p.enabled)return r.ray.intersectPlane(o,l)&&u.position.copy(l.sub(c)),void p.dispatchEvent({type:"drag",object:u})}function w(i){i.preventDefault(),i=i.changedTouches[0];var a=n.getBoundingClientRect();s.x=(i.clientX-a.left)/a.width*2-1,s.y=-(i.clientY-a.top)/a.height*2+1,r.setFromCamera(s,e);var d=r.intersectObjects(t);d.length>0&&(u=d[0].object,o.setFromNormalAndCoplanarPoint(e.getWorldDirection(o.normal),u.position),r.ray.intersectPlane(o,l)&&c.copy(l).sub(u.position),n.style.cursor="move",p.dispatchEvent({type:"dragstart",object:u}))}function E(t){t.preventDefault(),u&&(p.dispatchEvent({type:"dragend",object:u}),u=null),n.style.cursor="auto"}h(),this.enabled=!0,this.activate=h,this.deactivate=f,this.dispose=m,this.setObjects=function(){console.error("THREE.DragControls: setObjects() has been removed.")},this.on=function(t,e){console.warn("THREE.DragControls: on() has been deprecated. Use addEventListener() instead."),p.addEventListener(t,e)},this.off=function(t,e){console.warn("THREE.DragControls: off() has been deprecated. Use removeEventListener() instead."),p.removeEventListener(t,e)},this.notify=function(t){console.error("THREE.DragControls: notify() has been deprecated. Use dispatchEvent() instead."),p.dispatchEvent({type:t})}}c.prototype=Object.create(a["g"].prototype),c.prototype.constructor=c;n("7f7f");function l(t,e){var n=this,i={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.camera=t,this.objects=[],this._hovered=null,this._selected=null,this.domElement=void 0!==e?e:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new a["E"];var o=1e-6,r=new a["E"],s=i.NONE,c=i.NONE,l=new a["E"],u=new a["D"],d=new a["D"],p=new a["E"],h=0,f=new a["D"],m=new a["D"],v=0,g=0,y=new a["D"],b=new a["D"];this.target0=this.target.clone(),this.position0=this.camera.position.clone(),this.up0=this.camera.up.clone();var w={type:"change"},E={type:"start"},O={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var t=this.domElement.getBoundingClientRect(),e=this.domElement.ownerDocument.documentElement;this.screen.left=t.left+window.pageXOffset-e.clientLeft,this.screen.top=t.top+window.pageYOffset-e.clientTop,this.screen.width=t.width,this.screen.height=t.height}},this.handleEvent=function(t){"function"==typeof this[t.type]&&this[t.type](t)},this.setObjects=function(t){t.forEach(function(t){n.objects.push(t)})};var S=function(){var t=n.camera,i=new a["D"],o=new a["u"],r=e.getBoundingClientRect(),s=n.objects;return function(e){return i.x=(e.clientX-r.left)/r.width*2-1,i.y=-(e.clientY-r.top)/r.height*2+1,o.setFromCamera(i,t),o.intersectObjects(s)}}(),x=function(){var t=new a["D"];return function(e,i){return t.set((e-n.screen.left)/n.screen.width,(i-n.screen.top)/n.screen.height),t}}(),L=function(){var t=new a["D"];return function(e,i){return t.set((e-.5*n.screen.width-n.screen.left)/(.5*n.screen.width),(n.screen.height+2*(n.screen.top-i))/n.screen.width),t}}();function A(t){if(!1!==n.enabled&&0!=n.objects.length){var i=S(t);if(i.length>0){var o=i[0].object;n._hovered!==o&&(n.dispatchEvent({type:"hoveron",object:o}),e.style.cursor="pointer",e.title=o.name+"\nx:"+o.position.x+"\ny:"+o.position.y+"\nz:"+o.position.z,n._hovered=o)}else null!==n._hovered&&(n.dispatchEvent({type:"hoveroff",object:this._hovered}),e.style.cursor="auto",e.title="",n._hovered=null)}}function D(t){!1!==n.enabled&&(window.removeEventListener("keydown",D),c=s,s===i.NONE&&(t.keyCode!==n.keys[i.ROTATE]||n.noRotate?t.keyCode!==n.keys[i.ZOOM]||n.noZoom?t.keyCode!==n.keys[i.PAN]||n.noPan||(s=i.PAN):s=i.ZOOM:s=i.ROTATE))}function j(t){!1!==n.enabled&&(s=c,window.addEventListener("keydown",D,!1))}function M(t){if(!1!==n.enabled){t.preventDefault(),t.stopPropagation();var e=S(t);if(e.length>0){var o=e[0].object;n._selected!==o&&(n.dispatchEvent({type:"hoveron",object:o}),n._selected=o)}else null!==n._selected&&(n.dispatchEvent({type:"hoveroff",object:this._selected}),n._selected=null);s===i.NONE&&(s=t.button),s!==i.ROTATE||n.noRotate?s!==i.ZOOM||n.noZoom?s!==i.PAN||n.noPan||(y.copy(x(t.pageX,t.pageY)),b.copy(y)):(f.copy(x(t.pageX,t.pageY)),m.copy(f)):(d.copy(L(t.pageX,t.pageY)),u.copy(d)),document.removeEventListener("mousemove",A),document.addEventListener("mousemove",_,!1),document.addEventListener("mouseup",C,!1),n.dispatchEvent(E)}}function _(t){!1!==n.enabled&&(t.preventDefault(),t.stopPropagation(),s!==i.ROTATE||n.noRotate?s!==i.ZOOM||n.noZoom?s!==i.PAN||n.noPan||b.copy(x(t.pageX,t.pageY)):m.copy(x(t.pageX,t.pageY)):(u.copy(d),d.copy(L(t.pageX,t.pageY))))}function C(t){!1!==n.enabled&&(t.preventDefault(),t.stopPropagation(),s=i.NONE,document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",C),document.addEventListener("mousemove",A,!1),n.dispatchEvent(O))}function T(t){if(!1!==n.enabled&&!0!==n.noZoom){switch(t.preventDefault(),t.stopPropagation(),t.deltaMode){case 2:f.y-=.025*t.deltaY;break;case 1:f.y-=.01*t.deltaY;break;default:f.y-=25e-5*t.deltaY;break}n.dispatchEvent(E),n.dispatchEvent(O)}}function B(t){if(!1!==n.enabled){switch(t.touches.length){case 1:s=i.TOUCH_ROTATE,d.copy(L(t.touches[0].pageX,t.touches[0].pageY)),u.copy(d);break;default:s=i.TOUCH_ZOOM_PAN;var e=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY;g=v=Math.sqrt(e*e+o*o);var a=(t.touches[0].pageX+t.touches[1].pageX)/2,r=(t.touches[0].pageY+t.touches[1].pageY)/2;y.copy(x(a,r)),b.copy(y);break}n.dispatchEvent(E)}}function z(t){if(!1!==n.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:u.copy(d),d.copy(L(t.touches[0].pageX,t.touches[0].pageY));break;default:var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY;g=Math.sqrt(e*e+i*i);var o=(t.touches[0].pageX+t.touches[1].pageX)/2,a=(t.touches[0].pageY+t.touches[1].pageY)/2;b.copy(x(o,a));break}}function N(t){if(!1!==n.enabled){switch(t.touches.length){case 0:s=i.NONE;break;case 1:s=i.TOUCH_ROTATE,d.copy(L(t.touches[0].pageX,t.touches[0].pageY)),u.copy(d);break}n.dispatchEvent(O)}}function k(t){!1!==n.enabled&&t.preventDefault()}this.rotateCamera=function(){var t,e=new a["E"],i=new a["t"],o=new a["E"],r=new a["E"],s=new a["E"],c=new a["E"];return function(){c.set(d.x-u.x,d.y-u.y,0),t=c.length(),t?(l.copy(n.camera.position).sub(n.target),o.copy(l).normalize(),r.copy(n.camera.up).normalize(),s.crossVectors(r,o).normalize(),r.setLength(d.y-u.y),s.setLength(d.x-u.x),c.copy(r.add(s)),e.crossVectors(c,l).normalize(),t*=n.rotateSpeed,i.setFromAxisAngle(e,t),l.applyQuaternion(i),n.camera.up.applyQuaternion(i),p.copy(e),h=t):!n.staticMoving&&h&&(h*=Math.sqrt(1-n.dynamicDampingFactor),l.copy(n.camera.position).sub(n.target),i.setFromAxisAngle(p,h),l.applyQuaternion(i),n.camera.up.applyQuaternion(i)),u.copy(d)}}(),this.zoomCamera=function(){var t;s===i.TOUCH_ZOOM_PAN?(t=v/g,v=g,l.multiplyScalar(t)):(t=1+(m.y-f.y)*n.zoomSpeed,1!==t&&t>0&&l.multiplyScalar(t),n.staticMoving?f.copy(m):f.y+=(m.y-f.y)*this.dynamicDampingFactor)},this.panCamera=function(){var t=new a["D"],e=new a["E"],i=new a["E"];return function(){t.copy(b).sub(y),t.lengthSq()&&(t.multiplyScalar(l.length()*n.panSpeed),i.copy(l).cross(n.camera.up).setLength(t.x),i.add(e.copy(n.camera.up).setLength(t.y)),n.camera.position.add(i),n.target.add(i),n.staticMoving?y.copy(b):y.add(t.subVectors(b,y).multiplyScalar(n.dynamicDampingFactor)))}}(),this.checkDistances=function(){n.noZoom&&n.noPan||(l.lengthSq()>n.maxDistance*n.maxDistance&&(n.camera.position.addVectors(n.target,l.setLength(n.maxDistance)),f.copy(m)),l.lengthSq()<n.minDistance*n.minDistance&&(n.camera.position.addVectors(n.target,l.setLength(n.minDistance)),f.copy(m)))},this.update=function(){l.subVectors(n.camera.position,n.target),n.noRotate||n.rotateCamera(),n.noZoom||n.zoomCamera(),n.noPan||n.panCamera(),n.camera.position.addVectors(n.target,l),n.checkDistances(),n.camera.lookAt(n.target),r.distanceToSquared(n.camera.position)>o&&(n.dispatchEvent(w),r.copy(n.camera.position))},this.reset=function(){s=i.NONE,c=i.NONE,n.target.copy(n.target0),n.camera.position.copy(n.position0),n.camera.up.copy(n.up0),l.subVectors(n.camera.position,n.target),n.camera.lookAt(n.target),n.dispatchEvent(w),r.copy(n.camera.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",k,!1),this.domElement.removeEventListener("mousedown",M,!1),this.domElement.removeEventListener("wheel",T,!1),this.domElement.removeEventListener("touchstart",B,!1),this.domElement.removeEventListener("touchend",N,!1),this.domElement.removeEventListener("touchmove",z,!1),document.removeEventListener("mousemove",_,!1),document.removeEventListener("mouseup",C,!1),window.removeEventListener("keydown",D,!1),window.removeEventListener("keyup",j,!1)},this.domElement.addEventListener("contextmenu",k,!1),this.domElement.addEventListener("mousedown",M,!1),this.domElement.addEventListener("wheel",T,!1),this.domElement.addEventListener("touchstart",B,!1),this.domElement.addEventListener("touchend",N,!1),this.domElement.addEventListener("touchmove",z,!1),window.addEventListener("keydown",D,!1),window.addEventListener("keyup",j,!1),this.handleResize(),this.update()}l.prototype=Object.create(a["g"].prototype),l.prototype.constructor=l;n("28a5");function u(t){this.manager=void 0!==t?t:a["e"]}Object.assign(u.prototype,{constructor:u,addEventListener:a["g"].prototype.addEventListener,hasEventListener:a["g"].prototype.hasEventListener,removeEventListener:a["g"].prototype.removeEventListener,dispatchEvent:a["g"].prototype.dispatchEvent,load:function(t,e){var n=this;n.parse(t,e)},parse:function(t,e){var n,i,o=[],r=[],s=[];n=/([\+|\-]?[\d]+\.?[\d|\-|e]*)[\s]+([\+|\-]?[\d]+\.?[\d|\-|e]*)[\s]+([\+|\-]?[\d]+\.?[\d|\-|e]*)[\s]+([\d]+\.?[\d|\-|e]*)[\s]+([\d]+\.?[\d|\-|e]*)[\s]+([\w|\.|\-]+)/g;var c=new a["p"]({color:3837670}),l=new a["z"];t.split(/\n/g).forEach(function(t){if(null!==(i=n.exec(t))){var e=new a["o"](l.clone(),c.clone());e.position.set(parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3])),e.name=i[6],o.push(e),r.push(parseFloat(i[5])),s.push(parseInt(i[4]))}n.lastIndex=0}),e(o,r,s)}});var d=n("4dd1"),p=n("6b43");n("63d9");function h(){a["l"].call(this),this.type="LineSegmentsGeometry";new a["b"];var t=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],e=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],n=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(n),this.addAttribute("position",new a["i"](t,3)),this.addAttribute("uv",new a["i"](e,2))}function f(t,e){a["o"].call(this),this.type="LineSegments2",this.geometry=void 0!==t?t:new h,this.material=void 0!==e?e:new g({color:16777215*Math.random()})}function m(t,e){f.call(this),this.type="Line2",this.geometry=void 0!==t?t:new v,this.material=void 0!==e?e:new g({color:16777215*Math.random()})}function v(){h.call(this),this.type="LineGeometry"}function g(t){a["x"].call(this,{type:"LineMaterial",uniforms:a["C"].clone(a["w"]["line"].uniforms),vertexShader:a["w"]["line"].vertexShader,fragmentShader:a["w"]["line"].fragmentShader}),this.dashed=!1,Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}}}),this.setValues(t)}h.prototype=Object.assign(Object.create(a["l"].prototype),{constructor:h,isLineSegmentsGeometry:!0,applyMatrix:function(t){var e=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==e&&(t.applyToBufferAttribute(e),t.applyToBufferAttribute(n),e.data.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},setPositions:function(t){var e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));var n=new a["m"](e,6,1);return this.addAttribute("instanceStart",new a["n"](n,3,0)),this.addAttribute("instanceEnd",new a["n"](n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this},setColors:function(t){var e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));var n=new a["m"](e,6,1);return this.addAttribute("instanceColorStart",new a["n"](n,3,0)),this.addAttribute("instanceColorEnd",new a["n"](n,3,3)),this},fromWireframeGeometry:function(t){return this.setPositions(t.attributes.position.array),this},fromEdgesGeometry:function(t){return this.setPositions(t.attributes.position.array),this},fromMesh:function(t){return this.fromWireframeGeometry(new a["H"](t.geometry)),this},fromLineSegements:function(t){var e=t.geometry;return e.isGeometry?this.setPositions(e.vertices):e.isBufferGeometry&&this.setPositions(e.position.array),this},computeBoundingBox:function(){var t=new a["a"];return function(){null===this.boundingBox&&(this.boundingBox=new a["a"]);var e=this.attributes.instanceStart,n=this.attributes.instanceEnd;void 0!==e&&void 0!==n&&(this.boundingBox.setFromBufferAttribute(e),t.setFromBufferAttribute(n),this.boundingBox.union(t))}}(),computeBoundingSphere:function(){var t=new a["E"];return function(){null===this.boundingSphere&&(this.boundingSphere=new a["y"]),null===this.boundingBox&&this.computeBoundingBox();var e=this.attributes.instanceStart,n=this.attributes.instanceEnd;if(void 0!==e&&void 0!==n){var i=this.boundingSphere.center;this.boundingBox.getCenter(i);for(var o=0,r=0,s=e.count;r<s;r++)t.fromBufferAttribute(e,r),o=Math.max(o,i.distanceToSquared(t)),t.fromBufferAttribute(n,r),o=Math.max(o,i.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}}(),toJSON:function(){},clone:function(){},copy:function(t){return this}}),f.prototype=Object.assign(Object.create(a["o"].prototype),{constructor:f,isLineSegments2:!0,computeLineDistances:function(){var t=new a["E"],e=new a["E"];return function(){for(var n=this.geometry,i=n.attributes.instanceStart,o=n.attributes.instanceEnd,r=new Float32Array(2*i.data.count),s=0,c=0,l=i.data.count;s<l;s++,c+=2)t.fromBufferAttribute(i,s),e.fromBufferAttribute(o,s),r[c]=0===c?0:r[c-1],r[c+1]=r[c]+t.distanceTo(e);var u=new a["m"](r,2,1);return n.addAttribute("instanceDistanceStart",new a["n"](u,1,0)),n.addAttribute("instanceDistanceEnd",new a["n"](u,1,1)),this}}(),copy:function(t){return this}}),m.prototype=Object.assign(Object.create(f.prototype),{constructor:m,isLine2:!0,copy:function(t){return this}}),v.prototype=Object.assign(Object.create(h.prototype),{constructor:v,isLineGeometry:!0,setPositions:function(t){for(var e=t.length-3,n=new Float32Array(2*e),i=0;i<e;i+=3)n[2*i]=t[i],n[2*i+1]=t[i+1],n[2*i+2]=t[i+2],n[2*i+3]=t[i+3],n[2*i+4]=t[i+4],n[2*i+5]=t[i+5];return h.prototype.setPositions.call(this,n),this},setColors:function(t){for(var e=t.length-3,n=new Float32Array(2*e),i=0;i<e;i+=3)n[2*i]=t[i],n[2*i+1]=t[i+1],n[2*i+2]=t[i+2],n[2*i+3]=t[i+3],n[2*i+4]=t[i+4],n[2*i+5]=t[i+5];return h.prototype.setColors.call(this,n),this},fromLine:function(t){var e=t.geometry;return e.isGeometry?this.setPositions(e.vertices):e.isBufferGeometry&&this.setPositions(e.position.array),this},copy:function(t){return this}}),a["B"].line={linewidth:{value:1},resolution:{value:new a["D"](1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},a["w"]["line"]={uniforms:a["C"].merge([a["B"].common,a["B"].fog,a["B"].line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\n\t\t\t#include <premultiplied_alpha_fragment>\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\n\t\t}\n\t\t"},g.prototype=Object.create(a["x"].prototype),g.prototype.constructor=g,g.prototype.isLineMaterial=!0,g.prototype.copy=function(t){return a["x"].prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.resolution=t.resolution,this};var y={name:"bn-view",data:function(){return{surfCenter:new a["E"](0,0,0),photoVisible:!1,photoList:[],scene:new a["v"],webGLRenderer:null,camera:null,controls:null,outputWidth:null,outputHeight:null,bnOption:this.$store.state.bnOption}},watch:{$route:function(t,e){console.log("route"),window.removeEventListener("resize",this.onOutputWindowResize,!1)},"bnOption.sflag":function(){if(this.bnOption.sflag){try{null!=this.bnOption.allDATA["surfDATA"]&&this.loadsurf(),null!=this.bnOption.allDATA["nodeDATA"]&&this.loadnode(),null!=this.bnOption.allDATA["edgeDATA"]&&this.loadedge(),null!=this.bnOption.NIFTIModel&&this.loadnifti(),this.$message.success("绘制曲面完成")}catch(t){this.$message.error(t)}this.bnOption.sflag=!1}},"bnOption.allMaterial.surfMaterial.color":function(){var t=this.scene.getObjectByName("surface");t instanceof a["o"]&&(t.material.color=new a["d"](parseInt(this.bnOption.allMaterial.surfMaterial.color.replace("#","0x"),16)))},"bnOption.allMaterial.surfMaterial.opacity":function(){var t=this.scene.getObjectByName("surface");t&&(t.material.opacity=this.bnOption.allMaterial.surfMaterial.opacity)},"bnOption.allMaterial.surfMaterial.clip":function(){var t=this.scene.getObjectByName("surface"),e=this.bnOption.allMaterial.surfMaterial.clip,n=this.bnOption.allMaterial.surfMaterial.clipOffset;if(t){var i=[];e&&(i=[new a["s"](new a["E"](-1,0,0),-n[0]),new a["s"](new a["E"](1,0,0),n[1])]),this.webGLRenderer.localClippingEnabled=e,t.material.setValues({clippingPlanes:i})}},"bnOption.allMaterial.surfMaterial.clipOffset":function(){var t=this.scene.getObjectByName("surface"),e=this.bnOption.allMaterial.surfMaterial.clip,n=this.bnOption.allMaterial.surfMaterial.clipOffset;if(t&&e){var i=[];e&&(i=[new a["s"](new a["E"](-1,0,0),-n[0]),new a["s"](new a["E"](1,0,0),n[1])]),this.webGLRenderer.localClippingEnabled=e,t.material.setValues({clippingPlanes:i})}},"bnOption.lflag":function(){if(this.bnOption.lflag){this.scene.getObjectByName("edge");var t=this.bnOption.allMaterial.lineMaterial.lineWidth;this.drawMatrix(t[0],t[1])}this.bnOption.lflag=!1},surfCenter:function(){console.log(this.surfCenter);var t=this.controls.target.copy(this.surfCenter);Math.abs(t.x)>10&&(t.x=0),this.controls.target.copy(t)}},methods:{onOutputWindowResize:function(){null!==document.getElementById("Info-output")&&(this.outputWidth=document.getElementById("main").clientWidth,this.outputHeight=window.innerHeight,this.webGLRenderer&&(this.webGLRenderer.setSize(.8*this.outputWidth,this.outputHeight),this.camera.aspect=.8*this.outputWidth/this.outputHeight,this.camera.updateProjectionMatrix(),document.getElementById("Info-output").style.height=window.innerHeight))},init:function(){var t=this.scene,e=.8*this.outputWidth,n=this.outputHeight,i=this.camera=new a["r"](45,e/n,.1,1e3),o=this.webGLRenderer=new a["G"]({preserveDrawingBuffer:!0,opacity:.5}),r=new a["A"](16777215);o.setClearColor(new a["d"](16777215)),o.setSize(e,n),i.position.set(0,250,0),i.up.set(0,0,1),i.lookAt(new a["E"](0,0,0)),r.position.copy(i.position),t.add(r),document.getElementById("WebGL-output").appendChild(o.domElement);var s=new l(i,o.domElement);function c(){o.clear(),s.update(),r.position.copy(i.position),requestAnimationFrame(c),o.render(t,i)}s.rotateSpeed=6,this.controls=s,c()},removeObject:function(t){return t instanceof a["o"]?(this.scene.remove(t),t.material.dispose(),void t.geometry.dispose()):t instanceof a["k"]?(this.scene.remove(t),void t.children.forEach(this.removeObject)):void 0},loadsurf:function(){var t=this.camera,e=new s,n=this.scene,i=this.bnOption.allMaterial.surfMaterial,o=this;this.removeObject(n.getObjectByName("surface")),e.load(this.bnOption.allDATA["surfDATA"],function(e){e.computeBoundingSphere(),o.surfCenter=e.boundingSphere.center,t.lookAt(o.surfCenter);var r=new a["q"]({color:parseInt(i.color.replace("#","0x"),16),side:a["f"],opacity:i.opacity,transparent:!0,vertexColors:a["F"]}),s=new a["o"](e,r);s.name="surface",n.add(s)}),delete this.bnOption.allDATA["surfDATA"],this.bnOption.allMaterial.surfMaterial.clip=!1},loadnode:function(){var t=new u,e=this.scene,n=this.controls;this.removeObject(e.getObjectByName("node")),this.removeObject(e.getObjectByName("edge"));var i=[16776960,16711935,65535,16711680,9498256,8900346,0,16777215];t.load(this.bnOption.allDATA["nodeDATA"],function(t,o,r){var s=new a["k"];s.name="node",t.forEach(function(t,e){t.material.color.set(i[r[e]]);var n=o[e]+.1;t.scale.set(n,n,n),t.code=r,s.add(t)}),e.add(s),n.setObjects(t)}),delete this.bnOption.allDATA["nodeDATA"]},loadedge:function(){var t=new d["a"],e=this.bnOption.allMaterial.lineMaterial,n=t.loadAList(this.bnOption.allDATA["edgeDATA"]);p["a"].setLocal("edgeAlist",n.list),e.minWeight=n.min,e.maxWeight=n.max,e.lineWidth=[n.max-(n.max-n.min)/10,n.max,n.list],this.bnOption.lflag=!0,delete this.bnOption.allDATA["edgeDATA"]},drawMatrix:function(t,e,n){var i=this.scene,o=this.bnOption.allMaterial.lineMaterial.color,r=this.bnOption.allMaterial.lineMaterial.size;this.removeObject(i.getObjectByName("edge"));var s=i.getObjectByName("node");if(void 0===s||0===s.children.length)throw"还未添加node";if(s=s.children,void 0===n&&(n=JSON.parse(p["a"].getLocal("edgeAlist"))),!n)throw"添加的矩阵已失效";var c=new a["k"];c.name="edge",i.add(c),n.forEach(function(n){var i=n[0],a=n[1],l=n[2];if(!(l<t||l>e)){var u=[];u.push(s[i].position.x,s[i].position.y,s[i].position.z),u.push(s[a].position.x,s[a].position.y,s[a].position.z);var d=new v;d.setPositions(u);var p=new g({color:parseInt(o.replace("#","0x"),16),linewidth:.005*l*r,dashed:!1}),h=new m(d,p);c.add(h)}})},loadnifti:function(){var t=r["f"](0,0,255),e=r["f"](255,0,0),n=r["d"](e,t),i=this.scene.getObjectByName("surface");if(null!=i){var o=this.bnOption.NIFTIModel.niftiHeader,s=o.dims,c=[],l=this.bnOption.NIFTIModel.niftiImage;c[0]=0,c[1]=o.affine[0][3],c[2]=o.affine[1][3],c[3]=o.affine[2][3];for(var u,d=i.geometry.attributes.position.array,p=i.geometry.attributes.color.array,h=new a["d"],f=0;f<d.length;f+=3)u=m({x:d[f],y:d[f+1],z:d[f+2]}),0!=u&&(h.set(u),p[f]=h.r,p[f+1]=h.g,p[f+2]=h.b);i.geometry.attributes.color.needsUpdate=!0}function m(t){var e=Math.round(t.x-c[1]),i=Math.round(t.y-c[2]),o=Math.round(t.z-c[3]);e>s[1]&&(e=s[1]),i>s[2]&&(i=s[2]),o>s[3]&&(o=s[3]),e<0&&(e=0),i<0&&(i=0),o<0&&(o=0);var a=l[(o*s[2]+i)*s[1]+e];return n(a/116)}},viewDirection:function(t){var e=this.camera;"front"===t?(e.position.set(0,250,0),e.up.set(0,0,1)):"back"===t?(e.position.set(0,-250,0),e.up.set(0,0,1)):"left"===t?(e.position.set(-250,0,0),e.up.set(0,0,1)):"right"===t?(e.position.set(250,0,0),e.up.set(0,0,1)):"top"===t?(e.position.set(0,0,250),e.up.set(0,1,0)):"bottom"===t&&(e.position.set(0,0,-250),e.up.set(0,1,0)),e.lookAt(new a["E"](0,0,0))},photo:function(){this.photoVisible=!0,this.photoList=[];var t=this,e=this.camera,n=this.webGLRenderer,i=Math.min(this.outputWidth,this.outputHeight);function o(i){"front"===i?(e.position.set(0,250,0),e.up.set(0,0,1)):"back"===i?(e.position.set(0,-250,0),e.up.set(0,0,1)):"left"===i?(e.position.set(-250,0,0),e.up.set(0,0,1)):"right"===i?(e.position.set(250,0,0),e.up.set(0,0,1)):"top"===i?(e.position.set(0,0,250),e.up.set(0,1,0)):"bottom"===i&&(e.position.set(0,0,-250),e.up.set(0,1,0)),setTimeout(function(){var e=document.createElement("img");e.src=n.domElement.toDataURL("image/jpeg"),t.photoList.push(e.src),e.width=300,e.height=300,document.getElementById("photo").appendChild(e)},500)}this.webGLRenderer.setSize(i,i),this.camera.aspect=1,this.camera.updateProjectionMatrix(),setTimeout(function(){for(var e=["front","back","left","right","top","bottom"],n=function(t){setTimeout(function(){return o(e[t-1])},1e3*t)},i=1;i<=e.length;i++)n(i);setTimeout(function(){t.onOutputWindowResize()},1e3*e.length+1e3)},1e3)}},mounted:function(){this.outputWidth=document.getElementById("main").clientWidth,this.outputHeight=window.innerHeight,window.addEventListener("resize",this.onOutputWindowResize,!1),document.addEventListener("unload",this.saveState),this.init(),this.onOutputWindowResize()}},b=y,w=(n("6959"),n("2877")),E=Object(w["a"])(b,i,o,!1,null,"0b9f6432",null);E.options.__file="View.vue";e["default"]=E.exports},"386b":function(t,e,n){var i=n("5ca1"),o=n("79e5"),a=n("be13"),r=/"/g,s=function(t,e,n,i){var o=String(a(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(i).replace(r,"&quot;")+'"'),s+">"+o+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(s),i(i.P+i.F*o(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)}},"63d9":function(t,e,n){n("ec30")("Float32",4,function(t){return function(e,n,i){return t(this,e,n,i)}})},"673e":function(t,e,n){"use strict";n("386b")("sub",function(t){return function(){return t(this,"sub","","")}})},6959:function(t,e,n){"use strict";var i=n("9282"),o=n.n(i);o.a},9282:function(t,e,n){}}]);