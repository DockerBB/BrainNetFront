(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a78a317"],{"28a5":function(e,t,n){n("214f")("split",2,function(e,t,i){"use strict";var a=n("aae3"),s=i,r=[].push,o="split",l="length",c="lastIndex";if("c"=="abbc"[o](/(b)*/)[1]||4!="test"[o](/(?:)/,-1)[l]||2!="ab"[o](/(?:ab)*/)[l]||4!="."[o](/(.?)(.?)/)[l]||"."[o](/()()/)[l]>1||""[o](/.?/)[l]){var u=void 0===/()??/.exec("")[1];i=function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!a(e))return s.call(n,e,t);var i,o,f,d,m,g=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,v=void 0===t?4294967295:t>>>0,b=new RegExp(e.source,p+"g");u||(i=new RegExp("^"+b.source+"$(?!\\s)",p));while(o=b.exec(n)){if(f=o.index+o[0][l],f>h&&(g.push(n.slice(h,o.index)),!u&&o[l]>1&&o[0].replace(i,function(){for(m=1;m<arguments[l]-2;m++)void 0===arguments[m]&&(o[m]=void 0)}),o[l]>1&&o.index<n[l]&&r.apply(g,o.slice(1)),d=o[0][l],h=f,g[l]>=v))break;b[c]===o.index&&b[c]++}return h===n[l]?!d&&b.test("")||g.push(""):g.push(n.slice(h)),g[l]>v?g.slice(0,v):g}}else"0"[o](void 0,0)[l]&&(i=function(e,t){return void 0===e&&0===t?[]:s.call(this,e,t)});return[function(n,a){var s=e(this),r=void 0==n?void 0:n[t];return void 0!==r?r.call(n,s,a):i.call(String(s),n,a)},i]})},"2fdb":function(e,t,n){"use strict";var i=n("5ca1"),a=n("d2c8"),s="includes";i(i.P+i.F*n("5147")(s),"String",{includes:function(e){return!!~a(this,e,s).indexOf(e,arguments.length>1?arguments[1]:void 0)}})},4917:function(e,t,n){n("214f")("match",1,function(e,t,n){return[function(n){"use strict";var i=e(this),a=void 0==n?void 0:n[t];return void 0!==a?a.call(n,i):new RegExp(n)[t](String(i))},n]})},5147:function(e,t,n){var i=n("2b4c")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,!"/./"[e](t)}catch(e){}}return!0}},6762:function(e,t,n){"use strict";var i=n("5ca1"),a=n("c366")(!0);i(i.P,"Array",{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")("includes")},"6a20":function(e,t,n){},"90d7":function(e,t,n){"use strict";var i=n("6a20"),a=n.n(i);a.a},aae3:function(e,t,n){var i=n("d3f4"),a=n("2d95"),s=n("2b4c")("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==a(e))}},b4ac:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form",{attrs:{"label-position":"left","label-width":"280px"},model:{value:e.temporalFilteringOptions,callback:function(t){e.temporalFilteringOptions=t},expression:"temporalFilteringOptions"}},[n("h1",[e._v("Create Task")]),n("el-form-item",{attrs:{label:"Task Name"}},[n("el-autocomplete",{staticStyle:{width:"300px"},attrs:{"fetch-suggestions":e.querySearch},model:{value:e.taskname,callback:function(t){e.taskname=t},expression:"taskname"}})],1),n("el-form-item",{attrs:{label:"Drag and Drop File Uploading Zone"}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.showuploading,expression:"showuploading"}],ref:"select_frame",staticClass:"myCenter myupload",staticStyle:{float:"left"},attrs:{"element-loading-text":e.uploadmsg,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{click:function(){return e.showuploading=e.uploading}}},[n("i",{staticClass:"el-icon-plus",staticStyle:{"font-size":"50px",color:"#8cc5ff"}})])])],1),n("el-dialog",{attrs:{title:"sMRI REPORT",visible:e.runDialogTableVisible},on:{"update:visible":function(t){e.runDialogTableVisible=t}}},[n("div",{staticStyle:{"white-space":"pre-wrap"}},[n("p",{domProps:{innerHTML:e._s(e.smriTextarea)}})])]),n("div",{staticStyle:{"text-align":"center"}},[n("el-button",{staticStyle:{margin:"10px auto 0 auto","font-size":"1.5rem"},attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("run")])],1)],1)},a=[],s=(n("28a5"),n("6762"),n("2fdb"),n("4917"),n("7f7f"),n("ac6a"),n("cadf"),n("551c"),n("097d"),n("6b43")),r={name:"smri",data:function(){return{active:0,uploading:!1,showuploading:!1,uploadmsg:"",taskList:[],filePathOptions:[],filePath:"",fileListType:"",setPathEle:[],taskname:"",smriTextarea:"",runDialogTableVisible:!1}},mounted:function(){var e=this;this.initUploadField(),this.$axios.get("/getdirlist/smri").then(function(t){var n=[];t.data.data.forEach(function(e){return n.push({value:e.name})}),e.taskList=n,e.taskname=0===n.length?"task":n[0].value})},watch:{"$store.state.smri.smriState":function(){var e=this;"finish"===this.$store.state.smri.smriState&&this.$confirm("smri脚本运行结束，是否下载结果？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"下载",cancelButtonText:"否"}).then(function(){return e.downloadResult()}).catch(function(){return e.$message.info("运行结果可在home查看")})},"$store.state.smri.outputText":function(){this.runDialogTableVisible=!0;var e=this.$store.state.smri.outputText;this.smriTextarea+="\n"+e}},methods:{onSubmit:function(){var e=this;this.$axios.post("/find",["/smri/"+this.taskname+"/data"]).then(function(e){return"success"===e.data.data[0].match(/-find\s(.+)/)[1]?Promise.resolve():Promise.reject()}).then(function(){var t={smri:"json"};e.$axios.post("/smri/"+e.taskname+"/"+s["a"].getToken(),{jsonstr:JSON.stringify(t)}).then(function(t){return e.$message({message:t.data.message,type:"info"})})}).catch(function(){return e.$message({message:"you have no upload data yet",type:"info"})})},downloadResult:function(){var e="/MyFile/smri/"+this.taskname+"/working.zip",t=document.createElement("a");t.download=this.taskname+"_working.zip",t.href="http:"+window.g.API_URL+e,t.click()},querySearch:function(e,t){var n=this.taskList,i=e?n.filter(function(t){return!e||t.value.toLowerCase().includes(e.toLowerCase())}):n;t(i)},initUploadField:function(e){var t=this;this.$refs.select_frame.ondragleave=function(e){e.preventDefault()},this.$refs.select_frame.ondrop=function(e){e.preventDefault();var n=t;if(!0!==n.uploading){var i=[],a=0,s=0;n.uploading=!0,n.showuploading=!0,u(e.dataTransfer.items);var r=[];n.taskList.forEach(function(e){return r.push(e.value)}),r.indexOf(n.taskname)>-1?n.$confirm("任务已存在，是否删除原有任务中的数据和结果？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"是",cancelButtonText:"否"}).then(function(){n.uploading&&n.$axios.delete("/MyFile/smri/"+n.taskname).then(function(){n.$refs["select_frame"].setAttribute("element-loading-spinner","el-icon-loading"),n.$refs["select_frame"].getElementsByClassName("el-loading-spinner")[0].getElementsByTagName("i")[0].setAttribute("class","el-icon-loading"),n.uploadmsg="文件上传("+s+"/"+a+")",o()})}).catch(function(){return n.showuploading=!1}):setTimeout(function(){n.uploading&&(n.$refs["select_frame"].setAttribute("element-loading-spinner","el-icon-loading"),n.$refs["select_frame"].getElementsByClassName("el-loading-spinner")[0].getElementsByTagName("i")[0].setAttribute("class","el-icon-loading"),n.uploadmsg="文件上传("+s+"/"+a+")",o())},1e3)}function o(){if(0===i.length)return n.$axios.get("/getdirlist/smri").then(function(e){var t=[];e.data.data.forEach(function(e){return t.push({value:e.name})}),n.taskList=t}),n.uploading=!1,n.uploadmsg="文件上传成功，一共"+a+"个文件",n.$refs["select_frame"].setAttribute("element-loading-spinner","el-icon-success"),void n.$refs["select_frame"].getElementsByClassName("el-loading-spinner")[0].getElementsByTagName("i")[0].setAttribute("class","el-icon-success");var e=i.pop(),t=new FormData,r=void 0===e.fullPath?e.name:e.fullPath;r=n.taskname+"/data/"+r,t.append("uploadfile",e,encodeURIComponent(r)),n.$axios.post("/uploadfiles/smri",t,{onUploadProgress:function(e){n.uploadmsg="文件上传("+s+"/"+a+")  "+Math.ceil(e.loaded/e.total*100)+"%"}}).then(function(e){s++,n.uploadmsg="文件上传("+s+"/"+a+")",o()}).catch(function(e){n.$message.warning(e),n.$refs["select_frame"].setAttribute("element-loading-spinner","el-icon-error"),n.$refs["select_frame"].getElementsByClassName("el-loading-spinner")[0].getElementsByTagName("i")[0].setAttribute("class","el-icon-error"),n.uploadmsg="文件上传失败"})}function l(e){if(e.size>157286400)return n.uploading=!1,n.$refs["select_frame"].setAttribute("element-loading-spinner","el-icon-error"),n.$refs["select_frame"].getElementsByClassName("el-loading-spinner")[0].getElementsByTagName("i")[0].setAttribute("class","el-icon-error"),n.uploadmsg="文件上传失败, 存在数据文件大小大于150M",void console.error("文件上传失败, 文件"+e.fullPath+"大小大于150M");if(n.uploading){var t=e.fullPath.split("/");if("session_1"!==t[1]||"rest_1"!==t[2]&&"anat_1"!==t[2])return n.uploading=!1,n.$refs["select_frame"].setAttribute("element-loading-spinner","el-icon-error"),n.$refs["select_frame"].getElementsByClassName("el-loading-spinner")[0].getElementsByTagName("i")[0].setAttribute("class","el-icon-error"),void(n.uploadmsg="文件上传失败, 数据路径不正确");"rest_1"!==t[2]&&(i.push(e),a++)}}function c(e,t){var n=e.createReader(),i=function(){return n.readEntries(function(e){e.forEach(function(e){e.isFile?e.file(function(e){e.fullPath=t+"/"+e.name,l(e)}):e.isDirectory&&c(e,t+"/"+e.name)})})};return i()}function u(e){for(var t=0;t<e.length;t++){var n=e[t],i=void 0;n.webkitGetAsEntry&&(i=n.webkitGetAsEntry())&&(i.isFile?l(n.getAsFile()):i.isDirectory&&c(i,i.name))}}},this.$refs.select_frame.ondragenter=function(e){e.preventDefault(),t.$refs.select_frame.border="2px dashed red"},this.$refs.select_frame.ondragover=function(e){e.preventDefault()}}}},o=r,l=(n("90d7"),n("2877")),c=Object(l["a"])(o,i,a,!1,null,"277d4491",null);c.options.__file="smri.vue";t["default"]=c.exports},d2c8:function(e,t,n){var i=n("aae3"),a=n("be13");e.exports=function(e,t,n){if(i(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(a(e))}}}]);